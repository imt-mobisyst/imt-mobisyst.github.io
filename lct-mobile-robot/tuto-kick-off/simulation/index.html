<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Simulation - Lct. Mobile-Robot</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Simulation";
        var mkdocs_page_input_path = "tuto-kick-off/simulation.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Lct. Mobile-Robot
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="" href="../../..">MobiSyst <</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Intro</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Kick-Off</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../basics/">OS and Shell</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../first-contact/">Nodes and Topics</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../package/">ROS Package</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../move/">Move the Robot</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Simulation</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Level-up</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto-level-up/range-sensor/">Range Sensor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto-level-up/camera-driver/">Camera Driver</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto-level-up/parameters/">Parameters</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Mastering</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto-mastering/slam/">S.L.A.M</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto-mastering/transform/">Move To</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tuto-mastering/vision/">Vision</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Challenge</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../challenge/kick-off/">Kick-off</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../challenge/challenge-1on2/">Challenge 1</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../challenge/challenge-2on2/">Challenge 2</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Appendix</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../appendix/installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../appendix/faq/">F.A.Q</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../pdf/"></a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Lct. Mobile-Robot</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Kick-Off</li>
      <li class="breadcrumb-item active">Simulation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="simulation-in-ros">Simulation in ROS</h1>
<p>Simulating robotics systems is crucial before doing real experiments.
It exsits several simulators:
- https://gazebosim.org/home
- https://www.coppeliarobotics.com
- https://carla.org
- https://github.com/osrf/vrx</p>
<p>In this turial, we will use Stage (2d) and Gazebo (3d).</p>
<h2 id="gazebo-simulator">Gazebo Simulator</h2>
<p><a href="http://gazebosim.org/">Gazebo</a> is a 3D simulator.
It makes it possible to rapidly test algorithms, design robots, perform regression testing, and train AI systems using realistic scenarios.
Gazebo is integrated with ROS and supports various robots out of the box.</p>
<p>Gazebo is heavily used by the DARPA challenges (cf. <a href="https://en.wikipedia.org/wiki/Gazebo_simulator">Wikipedia</a>).
You can see videos online (<a href="https://www.youtube.com/watch?v=v6-heLIg85o">example</a>) and even load the maps and robot model that are available.</p>
<h2 id="gazebo-installation">Gazebo Installation</h2>
<p>Verify that <em>Gazebo</em> is installed using:</p>
<pre><code class="language-console">dpkg -l | grep gazebo
</code></pre>
<p>You should have at least the following packages:</p>
<pre><code>ii  gazebo                                          11.10.2+dfsg-1                          amd64        Open Source Robotics Simulator - Binaries
ii  gazebo-common                                   11.10.2+dfsg-1                          all          Open Source Robotics Simulator - Shared files
ii  gazebo-plugin-base                              11.10.2+dfsg-1                          amd64        Open Source Robotics Simulator - base plug-ins
ii  libgazebo-dev                                   11.10.2+dfsg-1                          amd64        Open Source Robotics Simulator - Development Files
ii  libgazebo11:amd64                               11.10.2+dfsg-1                          amd64        Open Source Robotics Simulator - shared library
ii  ros-iron-gazebo-dev                             3.7.0-3jammy.20230622.191804            amd64        Provides a cmake config for the default version of Gazebo for the ROS distribution.
ii  ros-iron-gazebo-msgs                            3.7.0-3jammy.20231117.090251            amd64        Message and service data structures for interacting with Gazebo from ROS2.
ii  ros-iron-gazebo-plugins                         3.7.0-3jammy.20231117.111548            amd64        Robot-independent Gazebo plugins for sensors, motors and dynamic reconfigurable components.
ii  ros-iron-gazebo-ros                             3.7.0-3jammy.20231117.104944            amd64        Utilities to interface with Gazebo through ROS.
ii  ros-iron-gazebo-ros-pkgs                        3.7.0-3jammy.20231117.114324            amd64        Interface for using ROS with the Gazebo simulator.
ii  ros-iron-turtlebot3-gazebo                      2.2.5-4jammy.20231117.114359            amd64        Gazebo simulation package for the TurtleBot3
</code></pre>
<p>Install missing packages using:</p>
<pre><code class="language-console">sudo apt install &lt;pakage_name&gt;
</code></pre>
<h2 id="launch-your-first-gazebo-simulation">Launch your first Gazebo Simulation</h2>
<p>We propose some configuration into a <code>pkg-tsim</code> project, including a <code>tbot_sim</code> <em>ROS2</em> package.</p>
<pre><code class="language-sh">cd ~/ros_space
git clone https://github.com/imt-mobisyst/pkg-tsim
colcon build
source ./install/setup.bash
</code></pre>
<p>Then, you can launch a preconfigured simulation:</p>
<pre><code class="language-console">ros2 launch tbot_sim challenge-1.launch.py
</code></pre>
<p>Look at the content of this launch file <a href="https://bitbucket.org/imt-mobisyst/pkg-tsim/src/master/tbot_sim/launch/challenge-1.launch.py">here</a>.
We can see that Gazebo/ROS supports loading a world file describing the simulation environment and spawn elements such as robots.
This simulation spawns a robot configured like a <code>tbot</code> i.e. it is equipped with a laser range finder and a camera (kinect).
The interaction with the simulation will operate through ROS topics as it would be with a real robot with real equipment.</p>
<h2 id="quiz-on-challenge-1">Quiz on challenge 1</h2>
<p>While the challenge 1 simulation is running:</p>
<blockquote>
<p>Question: which topics are available i.e published by Gazebo?</p>
</blockquote>
<p>Hint: an infinite loop safely` is a versatile and powerful tool to display data published in topics.
Launch it:</p>
<pre><code class="language-console">rviz2
</code></pre>
<blockquote>
<p>Question: How to configure <code>rviz2</code> to visualize the laser scans?</p>
</blockquote>
<p>Be careful, ensure that <code>Global Option</code> / <code>Fixed frame</code> is correctly set to <code>base_link</code>.</p>
<blockquote>
<p>Question: why is this important? (hint: check your <code>tf</code> using <code>ros2 run tf2_tools view_frames</code>)</p>
</blockquote>
<p>You can also display the <code>tf</code> in <code>rviz2</code> directly.</p>
<blockquote>
<p>Question: How to visualize camera images using <code>rqt</code>?</p>
</blockquote>
<p><img alt="rviz2" src="../../files/SLAM/rviz_laserscan.png" /></p>
<h2 id="controlling-the-simulated-robot">Controlling the Simulated Robot</h2>
<p>Launch a simple node to control the simulated robot using keyboard:</p>
<pre><code class="language-console">ros2 run teleop_twist_keyboard teleop_twist_keyboard
</code></pre>
<h2 id="tuto_sim">tuto_sim</h2>
<p>Create a launch file that starts the appropriate configuration: the <code>challenge-1</code>, a configured <code>rviz2</code> displaying laser scans and the <code>teleop</code>.
We will prefer YAML format for launch file.</p>
<p>All the information you need are in the tutorials :
- <a href="https://docs.ros.org/en/iron/Tutorials/Intermediate/Launch/Launch-Main.html">Launch file documentation</a>
- <a href="https://docs.ros.org/en/iron/How-To-Guides/Launch-file-different-formats.html">Launch examples</a></p>
<p>Create <code>$ROS_WORKSPACE/pkg-tsim/tbot_sim/launch/tutosim_launch.yaml</code>
Add this code into this file to:</p>
<pre><code class="language-yaml">launch:

- include:
    file: &quot;$(find-pkg-share tbot_sim)/launch/challenge-1.launch.py&quot;

- node:
    pkg: &quot;rviz2&quot;
    exec: &quot;rviz2&quot;
    name: &quot;rviz2&quot;

- executable:
    cmd: gnome-terminal --tab -e 'ros2 run  teleop_twist_keyboard teleop_twist_keyboard'
</code></pre>
<p>Exercise: modify this launch file so that <code>rviz</code> loads a saved configuration file when it starts. This configuration file should add the laser data, ...</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../move/" class="btn btn-neutral float-left" title="Move the Robot"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../tuto-level-up/range-sensor/" class="btn btn-neutral float-right" title="Range Sensor">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../move/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../tuto-level-up/range-sensor/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../javascripts/mathjax.js"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
